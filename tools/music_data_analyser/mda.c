#include <stdio.h>
#include <stdlib.h>

int main()
{
    int data_voice1[] = {
        0x84, 0x45, 0x43, 0x44, 0x25, 0x26, 0x25, 0x26, 0x27,
        0x24, 0x4b, 0x2c, 0x2d,
        0x2c, 0x2d, 0x2e, 0x2b, 0x44, 0x25, 0x26, 0x25,
        0x26, 0x27, 0x24, 0x46, 0x64, 0x66, 0x47, 0x67,
        0x67, 0x46, 0x64, 0x66, 0x47, 0x67, 0x67, 0x27,
        0x29, 0x27, 0x49, 0x67, 0x44, 0x66, 0x64, 0x27,
        0x29, 0x27, 0x49, 0x67, 0x44, 0x66, 0x64, 0x32,
        0x35, 0x32, 0x50, 0x6e, 0x2f, 0x30, 0x31, 0x30,
        0x31, 0x32, 0x31, 0x2f, 0x2f, 0x4f, 0x50, 0x4f,
        0x2e, 0x2f, 0x30, 0x31, 0x30, 0x31, 0x32, 0x31,
        0x2f, 0x4f, 0x6d, 0x6b, 0x4e, 0x6c, 0x6a, 0x4f,
        0x6d, 0x6b, 0x4e, 0x6c, 0x6a,
        0x100
    };
    int data_voice2[] = {
        0x92, 0x31, 0x33,
        0x31, 0x31, 0x52, 0x33, 0x34, 0x33, 0x34,
        0x35, 0x32, 0x54, 0x32, 0x52, 0x75, 0x54, 0x32, 0x52,
        0x75, 0x8d, 0x8d, 0x2c, 0x2d, 0xce, 0x8d, 0x8d,
        0x2c, 0x2d, 0xce, 0x75, 0x34, 0x32, 0x30, 0x2e,
        0x2d, 0x2f, 0x30, 0x31, 0x30, 0x31, 0x32, 0x31,
        0x32, 0x35, 0x32, 0x35, 0x32, 0x35, 0x32, 0x2e,
        0x2d, 0x2f, 0x30, 0x31, 0x30, 0x31, 0x32, 0x31,
        0x32, 0x4b, 0x69, 0x67, 0x4c, 0x6a, 0x68, 0x4b,
        0x69, 0x67, 0x4c, 0x6a, 0x68, 0x32, 0x33, 0x32,
        0xb2, 0x33, 0x31, 0x32, 0x33, 0x34, 0x35, 0x36,
        0x35, 0x33, 0x32, 0x31, 0x31, 0x32, 0x33, 0x34,
        0x33, 0x34, 0x35, 0x36, 0x35, 0x36, 0x37, 0x36,
        0x100
    };
    char *notenames[] = {
        "A-0",
        "B-0",
        "C-1",
        "D-1",
        "E-1",
        "F-1",
        "G-1",
        "A-1",
        "B-1",
        "C-2",
        "D-2",
        "E-2",
        "F-2",
        "G-2",
        "A-2",
        "B-2",
        "C-3",
        "D-3",
        "E-3",
        "F-3",
        "G-3",
        "A-3",
        "B-3",
        "C-4"
    };
    int current_data = 0;
    int noteindex = 0;
    int noteduration = 0;
    int index_voice1 = 0;
    int index_voice2 = 0;
    int timer_voice1 = 0;
    int timer_voice2 = 0;
    int timer_global = 0;
    int quit = 0;

    printf ( "timer  | voice 1 | voice 2 \n" );
    printf ( "-------+---------+---------\n" );

    while ( !quit )
    {
        // noteindex = current_data & 0x1F;
        // noteduration = ( current_data & 0xE0 ) >> 5;
        // printf( "%s, duration: %02x\n", notenames[noteindex], noteduration );
        printf( " %04x  | ", timer_global );

        if ( timer_voice1 == 0 )
        {
            current_data = data_voice1[index_voice1];
            if ( current_data == 0x100 )
            {
                quit = 1;
            }
            noteindex = current_data & 0x1F;
            timer_voice1 = ( current_data & 0xE0 ) >> 5;
            printf( "%s     | ", notenames[noteindex] );
            index_voice1++;
        }
        else
        {
            printf( "---     | " );
            timer_voice1--;
        }

        if ( timer_voice2 == 0 )
        {
            current_data = data_voice2[index_voice2];
            if ( current_data == 0x100 )
            {
                quit = 1;
            }
            noteindex = current_data & 0x1F;
            timer_voice2 = ( current_data & 0xE0 ) >> 5;
            printf( "%s ", notenames[noteindex] );
            index_voice2++;
        }
        else
        {
            printf( "--- " );
            timer_voice2--;
        }

        printf( "\n" );

        timer_global++;
    }

    return EXIT_SUCCESS;
}
